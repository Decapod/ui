<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Decapod Stereo 3D Dewarp</title>
        
        <link rel="stylesheet" type="text/css" href="../../lib/infusion/framework/fss/css/fss-reset-global.css" />
        <link rel="stylesheet" type="text/css" href="../../core/styles/css/decapod.css" />
        <link rel="stylesheet" type="text/css" href="../../core/styles/css/stereo.css" />

        <!-- Required JavaScript modules for the Exporter component. -->
        <script type="text/javascript" src="../../lib/infusion/MyInfusion.js"></script>
        <script type="text/javascript" src="../../core/js/decapodContext.js"></script>
        <script type="text/javascript" src="../../core/js/messages.js"></script>
        <script type="text/javascript" src="../../core/js/decapodRequestsDemands.js"></script>
        <script type="text/javascript" src="../../core/js/decapodRequests.js"></script>
        <script type="text/javascript" src="../../core/js/eventBinder.js"></script> 
        <script type="text/javascript" src="../../core/js/statusDemands.js"></script>
        <script type="text/javascript" src="../../core/js/status.js"></script>
        <script type="text/javascript" src="../../core/js/buttonDemands.js"></script>
        <script type="text/javascript" src="../../core/js/button.js"></script>
        <script type="text/javascript" src="../../core/js/stereoDemands.js"></script>
        <script type="text/javascript" src="../../core/js/stereo.js"></script>
        <script type="text/javascript" src="../../core/js/message.js"></script>
        <script type="text/javascript" src="../../core/js/browse.js"></script>
        <script type="text/javascript" src="../../core/js/browseDemands.js"></script>
    </head>
    
    <body class="ds-dewarp">        
        <section class="ds-shared-decapod">
            
            <!-- TITLE BAR -->
            <header class="ds-shared-titleBar">
                <ul class="ds-shared-titleBar-flatList">
                    <li><p>Decapod 0.7</p></li>
                </ul>
            </header>

            <!-- DECAPOD CALIBRATE INTERFACE -->
            <section class="dc-stereo ds-shared-mainPane">
            </section>

            <!-- FOOTER -->
            <footer>
            </footer>
        </section>
        <script>
            // Priming cache for colour picker template only (only for dewarp UI).
            fluid.fetchResources.primeCacheFromResources("decapod.stereo.browse.colourPicker");

            decapod.dewarper(".dc-stereo", {
                events: {
                    onCapturesFileSelected: null,
                    onCapturesUploadStart: null,
                    onCapturesUploadSuccess: null,
                    onCapturesUploadError: null,

                    onCalibrationFileSelected: null,
                    onCalibrationUploadStart: null,
                    onCalibrationSuccess: null,
                    onCalibrationError: null,

                    onColourPickerStart: null,
                    onColourPickerSuccess: null,
                    onColourPickerError: null
                },
                listeners: {
                    onCapturesUploadStart: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.working"]
                    },
                    onCapturesUploadSuccess: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.uploadCapturesSuccess", "{arguments}.0"]
                    },
                    onCapturesUploadError: {
                        listener: "{that}.events.statusUpdated.fire"
                    },
                    onCalibrationUploadStart: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.working"]
                    },
                    onCalibrationSuccess: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.uploadCalibrationSuccess", "{arguments}.0"]
                    },
                    onCalibrationError: {
                        listener: "{that}.events.statusUpdated.fire"
                    },
                    onColourPickerStart: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.working"]
                    },
                    onColourPickerSuccess: {
                        listener: "{that}.events.statusUpdated.fire",
                        args: ["{that}.options.statuses.colourPickerSuccess", "{arguments}.0"]
                    },
                    onColourPickerError: {
                        listener: "{that}.events.statusUpdated.fire"
                    }
                },
                selectors: {
                    browseCalibration: ".dc-stereo-browseCalibration",
                    colourPicker: ".dc-stereo-colourPicker"
                },
                protoTree: {
                    title: {
                        messagekey: "title"
                    },
                    help: {
                        target: "${help}",
                        linktext: {
                            messagekey: "stereo_help"
                        }
                    },
                    browse: {
                        decorators: {
                            type: "fluid",
                            func: "decapod.stereo.browse.captures"
                        }
                    },
                    browseCalibration: {
                        decorators: {
                            type: "fluid",
                            func: "decapod.stereo.browse.calibration"
                        }
                    },
                    colourPicker: {
                        decorators: {
                            type: "fluid",
                            func: "decapod.stereo.browse.colourPicker"
                        }
                    }
                },
                strings: {
                    title: decapod.globalMessages.stereo_title_dewarp,
                    start: decapod.globalMessages.stereo_start_dewarp,
                    ready: decapod.globalMessages.stereo_ready_dewarp,
                    complete: decapod.globalMessages.stereo_complete_dewarp,
                    working: decapod.globalMessages.stereo_working_dewarp,
                    progress: decapod.globalMessages.stereo_progress_dewarp,
                    BAD_ZIP: decapod.globalMessages.stereo_BAD_ZIP,
                    NO_STEREO_IMAGES: decapod.globalMessages.stereo_NO_STEREO_IMAGES,
                    NOT_ENOUGH_IMAGES: decapod.globalMessages.stereo_NOT_ENOUGH_IMAGES,
                    error: decapod.globalMessages.stereo_error,
                    calibrationReady: decapod.globalMessages.stereo_calibrationReady,
                    readyToDewarp: decapod.globalMessages.stereo_readyToDewarp
                },
                urls: {
                    uploadCaptures: "../../captures",
                    uploadCalibration: "../../calibration",
                    colourPicker: "../../colourPicker",
                    process: "../../dewarpedArchive",
                    startOver: "dewarper.html"
                },
                statuses: {
                    uploadCapturesSuccess: "CAPTURES_FOUND",
                    uploadCalibrationSuccess: "CALIBRATION_READY",
                    colourPickerSuccess: "READY_TO_DEWARP",
                    processing: "DEWARPING"
                }
            });
        </script>
    </body>
</html>
