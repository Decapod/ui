<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="../../../../lib/infusion/framework/fss/css/fss-reset-global.css" />
        <link rel="stylesheet" type="text/css" href="../../core/styles/css/decapod.css" />
        <link rel="stylesheet" type="text/css" href="../../core/styles/css/help.css" />

        <title>Decapod Help - Stereo 3D Calibration</title>
    </head>

    <body>

        <section class="ds-shared-decapod ds-shared-help">

            <h1>Decapod Help - Stereo 3D Calibration</h1>

            <h2>What is Stereo 3D Calibration?</h2>

            <p>Stereo 3D calibration is the process of calculating the position and orientation of two cameras relative to each other.</p>

            <p>Calibration is important if images are captured using stereo 3D and need to be dewarped. Without the calibration information, the stereo images will not flatten.</p>

            <p>It is recommended that before any work using stereo 3D is done, this calibration process be completed first.</p>

            <h2>How Run Stereo 3D Calibration</h2>

            <p>To perform calibration, a checkerboard pattern is held in full view of both cameras and pictures are taken. Between taking each pair of photos, the checkerboard is tilted differently or its position changed before another photo is taken.</p>

            <p>A minimum of 23 pairs of photos are taken during this process.</p>

            <p>Once the image pairs are ready, they are processed through the Stereo 3D Calibration tool. The Stereo 3D Calibration tool generates a  file containing the calibration information, which is then saved to a user-specified location.</p>

            <ol>
                <li> Take at least 23 pairs of photos of the checkerboard pattern in different positions and orientations. For more detailed instructions, refer to the "How to Capture Calibration Photos" section in this document.</li>
                <li> Create a ZIP file containing all calibration image pairs (at least 23 pairs / 46 images total).</li>
                <li> Launch Firefox and load the Stereo 3D Calibration tool by entering the server’s address in the location bar. By default the address is: <a href="http://localhost:8080/"><code>http://localhost:8080/</code></a>.</li>
                <li> Add the ZIP file containing the image pairs (created in Step 2 above) and select “Calibrate” to begin the calibration process.</li>
                <li> Calibration may take up to 2 hours to complete with high resolution images.</li>
                <li> When calibration is complete, save the file <code>calibration.zip</code> to a location when prompted.</li>
            </ol>

            <p><code>calibration.zip</code> file is needed later for stereo dewarping, so it is recommended that the file be saved in a safe location, preferably the same directory where work is being done.</p>

            <h2>How to Capture Calibration Photos</h2>
            <p>Before taking any photos, the equipment used for capturing needs to be set up. To set up cameras for stereo 3D, please see the Decapod Equipment Setup Guide on the Decapod wiki: <a href="http://wiki.fluidproject.org/display/fluid/Decapod">http://wiki.fluidproject.org/display/fluid/Decapod</a>.</p>

            <p class="note"><em>Note:</em><br />
            When the cameras are in place, do not change their positions or orientation relative to each other during the calibration process or during stereo capture. If camera positioning is changed, the images captured up to this point should be deleted and the calibration process restarted.</p>

            <p>Once the equipment is in place, take 23 pairs of photos of the checkerboard. The checkerboard can be positioned in any way in front of the cameras as long as the following requirements are satisfied:</p>

            <ol>
                <li> Position checkerboard in front of cameras, and <em>ensure checkerboard is visible from both cameras</em>. If checkerboard is not completely visible, then adjust the cameras higher, or place the subject lower.</li>
                <li> Take test captures to ensure proper positioning. These test captures should be deleted and not be included in the final set of calibration images.</li>
                <li> While holding the checkerboard still, take a picture with both cameras. The Decapod capture tool can be helpful in this situation as it can take pictures from both cameras simultaneously.</li>
                <li> Change the tilt / position / orientation of the checkerboard while ensuring it is viewable by both cameras.</li>
                <li> Repeat Steps 3 to 4 until at least 23 pairs of photos are taken.</li>
            </ol>

            <p class="note"><em>Note:</em><br />
            It is recommended that all calibration images and calibration data be saved in a location that is associated with the work being done. This way it is clear that certain calibration data belongs with a particular unit of work.</p>

            <p>For additional examples and instruction of how to do this calibration, please visit the Decapod wiki: <a href="http://wiki.fluidproject.org/display/fluid/Decapod">http://wiki.fluidproject.org/display/fluid/Decapod</a>
            </p>

            <h2>Calibration Image File Names (Applies to Untethered Capture Only)</h2>

            <p class="note"><em>Note:</em><br />
            The calibration image filenames should follow an expected format, otherwise the Stereo 3D Calibration will not work.</p>

            <p>Stereo 3D Calibration expects at least 23 image pairs that follow this filename format: <code>capture-[capture #]-[camera #].[extension]</code>. Decapod supports dewarping of TIFF, PNG, and JPEG files.</p>
                
            <p><em>Example:</em></p>
            <ul>
            <li> capture-01-1.jpg (left image first)</li>
            <li> capture-01-2.jpg (right image)</li>
            <li> capture-02-1.jpg</li>
            <li> capture-02-2.jpg</li>
            <li> ... </li>
            <li> capture-23-1.jpg (left image first)</li>
            <li> capture-23-2.jpg (right image)</li>
            </ul>

            <p>In this example, images are grouped in pairs. In each pair there is a left and right image as indicated by "-1" and "-2" respectively.</p>

            <p class="note"><em>Note:</em><br />
	        The left image should always come before the right image in a pair (like in the above example). Reversing this order will cause calibration to give inaccurate results.</p>

            <h2>Using Decapod’s Capture Tool to do Calibration (Applies to Tethered Capture Only)</h2>
            <p>Decapod’s Capture application can make the calibration process easier by:
            <ul>
                <li> taking photos simultaneously from both cameras which can be faster than triggering the cameras manually.</li>
                <li> the Decapod Capture tool also creates a ZIP file of the images (with proper file names) so it can be used directly in the Stereo 3D Calibration tool without additional work.</li>
            </ul>
        </section>
    </body>
</html>
